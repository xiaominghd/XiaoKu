
<h1 align="center">陪伴机器人小酷</h1>

<p align="center">
  <img src="https://img.shields.io/badge/XiaoKu-小酷机器人-36CFC9?style=for-the-badge&logo=github&logoColor=white" alt="小酷机器人" />
  <img src="https://img.shields.io/badge/Python-3.10+-blue?style=for-the-badge&logo=python&logoColor=white" alt="Python 3.10+" />
  <img src="https://img.shields.io/badge/LLM-大语言模型-ff69b4?style=for-the-badge&logo=semantic-release&logoColor=white" alt="LLM" />
  <img src="https://img.shields.io/badge/License-MIT-green?style=for-the-badge" alt="MIT License" />
</p>

## ✨ 项目概述

**小酷**是一个拥有独特“人格”与“意识”的AI伴侣机器人。本项目的核心愿景是将个体的记忆与思考持久化保存，使其能够被随时感知与珍视，构建一个承载人类思维的数字存在。

当前版本（V1）探索了一种无需微调模型的对话系统架构，通过**多级快慢思考流水线**，显著提升对话系统的情境感知能力。

在未来迭代中，小酷将演进为用户与多个AI智能体（Agent）交互的统一代理入口，加速信息交换效率，并在现有的人与人社交网络之上，构建一层**Agent-to-Agent的社交网络**。

## 🚀 核心特性

### 🧠 人格与启动
- **冷启动支持**：每次对话都从一个预设的“有状态”人格开始，保证体验的连贯性。
- **人格一致性**：核心系统提示词仅包含人格定义与回复逻辑，确保人格的纯粹与稳定。结合对话感知模块，提供三类基础回复模式指导，提升交互自然度。

### 🧩 对话管理
- **Ku Event 事件单元**：在传统上下文窗口之上，构建以“事件”为粒度的对话管理单元。支持按事件控制对话流程，并可对单个事件片段进行独立存档与管理。
- **动态上下文管理**：采用可折叠的上下文标签与上下文压缩技术，在保证对话质量的同时，精确控制Token消耗与响应延迟。

### 📚 记忆与知识
- **Agentic RAG 记忆增强**：通过主动感知对话意图，提前检索相关历史记忆或补充外部知识，从而提升对话的真实感与信息深度。

## 🤖 工作流程概述

小酷的对话流程模拟了人类对话中的"感知-反应"过程，并在全程保持后台"思考"，以提供连贯、智能的交互体验。

### 🔄 流程概览

1. **连接建立**：用户创建连接后，系统立即调用事件感知系统，推荐潜在感兴趣的事件及相关背景信息，同时注入近期对话历史作为上下文感知，避免冷启动。
2. **对话循环**：每轮用户输入都会触发"感知-反应"链，并在后台异步执行"思考"任务，以优化对话质量。

### 👁️ 感知模块
当用户消息到达时，小酷快速判断其是否属于当前事件讨论范围：
- **若属于当前事件**：将消息追加至该事件的对话列表，更新事件状态。
- **若不属当前事件（或用户兴趣转移）**：触发事件切换或创建新事件。

**技术实现**：基于 Qwen Flash 模型构建，侧重低时延意图识别，以保障对话流畅性。

### ⚡ 反应模块
小酷依据当前事件，以 O(1) 时间复杂度构建大模型历史上下文，并传入大模型生成回复。为提升多样性，在保持基础人格的前提下动态选择三种回复逻辑。

**技术实现**：基于 Qwen Max（非思考模式）模型，确保回复质量与一致性。

### 💭 思考模块（后台任务）
在生成回复的同时，小酷异步执行以下任务以提升长期对话质量：

#### 📚 1. 记忆召回
采用 Agentic RAG 思路，根据当前事件召回历史聊天片段，并预测未来可能涉及的话题进行扩展召回。

#### 🧭 2. 对话指引
调用 Qwen Max（思考模式）模型进行实时监测：
- 检测幻觉或人格偏移
- 根据事件走向主动规划后续聊天方向

#### ✂️ 3. 上下文压缩
当触发压缩条件时，对当前事件的上下文窗口进行拆分：
- 总结远期信息
- 保留近期消息
- 仅压缩当前事件上下文，不直接修改对话窗口，以提升效率并减少用户感知落差

#### 💾 4. 事件存储
对话结束后，以事件为单位对聊天记录进行切片存储，确保话题相似的数据能被高效召回。

#### 📝 外部信息注入格式
思考模块的输出会作为外部信息注入到大模型历史对话中。为保持严格的 role 交替结构（user/assistant），注入信息采用以下格式：
```python
{"role":"user","content":"[系统提示信息开始]"}
{"role":"assistant","content":"外部信息[系统提示信息结束]"}
```
### 技术栈

- 前端：如 React、Vue、HTML/CSS/JavaScript 等
- 后端：如 Node.js、Python、Java、Go 等
- 数据库：如 MySQL、MongoDB、Redis 等
- 其他依赖：第三方库/服务



## 安装与部署

### 环境要求

- 操作系统要求
- 所需依赖（Node、Python、Java 等及其版本）
- 其他特殊要求

### 安装步骤

```bash
git clone <仓库地址>
cd <项目目录>
<安装依赖相关命令，如 npm install、pip install -r requirements.txt 等>
```

### 配置说明

- 配置项1：如何配置及其说明
- 配置项2：如何配置及其说明

### 启动项目

```bash
<启动命令，如 npm start、python main.py 等>
```

## 使用说明

项目的基础用法介绍、常用操作演示等。

## 目录结构

```text
项目根目录
│
├── src/                # 源代码目录
├── docs/               # 文档目录
├── scripts/            # 工具/脚本
├── tests/              # 测试代码
├── README.md           # 项目说明
├── package.json        # Node 项目依赖文件
├── requirements.txt    # Python 依赖清单 (如适用)
└── ...
```

## 常见问题

- 问题1：解决方法
- 问题2：解决方法

## 贡献指南

1. Fork 本仓库
2. 创建 feature 分支 (`git checkout -b feature/foo`)
3. 提交你的更改 (`git commit -am 'Add new feature'`)
4. 推送到分支 (`git push origin feature/foo`)
5. 提交 Pull Request

## 许可证

[MIT](LICENSE) 或其它协议

## 联系方式

- 作者：GongHaofeng
- 邮箱：1530383208@qq.com
- 更多联系方式...
